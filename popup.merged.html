<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>List Interaction Prototype</title>
<!-- Tailwind CSS -->
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {
    width: 320px;
    font-size: 12px;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', Arial, sans-serif;
    /* margin: 2; */
    /* padding: 0 10px 0 10px; */
  }
  .tab-content {
    display: none;
  }
  .tab-content.active {
    display: block;
  }
  .tab-button {
    width: 50%;
    text-align: center;
    /* border-top-right-radius: 1rem;
    border-top-left-radius: 1rem; */
  }
  .tab-button:not(.active) {
    color: antiquewhite;
    background-color: gray;
    border-bottom: 1px solid black;
  }
  .tab-button.active {
    background-color: white;
    /* border-color: black; */
    border-left: 1px solid black;
    border-right: 1px solid black;
    border-top: 1px solid black;
    border-bottom: none;
  }
  .search-bar {
    margin-bottom: 1rem;
  }
  /* .search-icon {
    position: absolute;
    left: 2.5rem;
    top: 0.5rem;
  } */
  #tabMenu {
    position: sticky;
    top: 0;
    background: white;
    z-index: 10;
  }
  .list-item {
    position: relative;
    padding: 0.5rem;
    border: 1px solid transparent;
    display: flex;
    align-items: center;
    box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
  }
  /* .list-item.selected {
    background-color: #e2e8f0;
  } */
  .list-item:focus {
    border-color: blue;
    outline: none;
  }
  .list-item .remove-btn {
    display: none;
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
  }
  .list-item:hover .remove-btn {
    display: block;
  }
  .truncated {
    display: block;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
</style>
</head>
<body class="bg-gray-100 font-sans">
<div class="container mx-auto mt-10">
  <div class="bg-white shadow-lg rounded-lg">
    <div class="border-b" id="tabMenu">
      <ul class="flex">
        <li class="tab-button active px-6 py-3 border-b-2 font-semibold text-sm" data-tab-target="#currentWindow">Current Window</li>
        <li class="tab-button px-6 py-3 border-b-2 font-semibold text-sm" data-tab-target="#allWindow">All Window</li>
      </ul>
    </div>
    <div class="p-6 relative">
      <!-- <span class="search-icon">üîç</span> -->
      <input type="text" placeholder=" üîé Search..." class="search-bar pl-12 p-2 w-full rounded border border-gray-300" id="searchInput" autofocus>
      <div id="currentWindow" class="tab-content active">
        <!-- Repeat this block for each tab item in the current window -->
        <!-- Original 5 items plus 10 additional items as per the new wireframe -->
        <!-- Items will be dynamically generated by the script below -->
      </div>
      <div id="allWindow" class="tab-content">
        <!-- Content for all windows will go here -->
        <!-- Original 5 items plus 10 additional items as per the new wireframe -->
        <!-- Items will be dynamically generated by the script below -->
      </div>
    </div>
  </div>
</div>

<script>
  const tabs = document.querySelectorAll('.tab-button');
  const tabContents = document.querySelectorAll('.tab-content');
  const searchInput = document.getElementById('searchInput');

  // Function to add sample items to the tabs
  function addSampleItems(tabContent, itemCount, prefix) {
    for (let i = 1; i <= itemCount; i++) {
      const item = document.createElement('div');
      // item.classList.add('flex', 'items-center', 'p-2', 'bg-blue-100', 'rounded', 'mb-2', 'list-item');
      item.classList.add('flex', 'items-center', 'p-2', 'rounded', 'mb-2', 'list-item');
      // item.classList.add('flex', 'items-center', 'p-2', 'rounded', 'mb-2', 'list-item', 'truncate');
      item.tabIndex = 0;
      let itemTitle = `${prefix} Item ${i} aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa`;
      let itemURL = 'https://via.placeholder.com/16';
      item.innerHTML = `
        <img class="mr-2" src="https://via.placeholder.com/16" alt="favicon">
        <div class='truncated'><span style=cursor:pointer title='${itemURL}'>${itemTitle}</span></div>
        <span class="remove-btn text-red-500">‚ùå</span>
      `;
      tabContent.appendChild(item);
    }
  }

  // Add 15 sample items to each tab content
  addSampleItems(document.getElementById('currentWindow'), 15, 'Sample');
  addSampleItems(document.getElementById('allWindow'), 15, 'All Window');

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      const target = document.querySelector(tab.dataset.tabTarget);
      tabContents.forEach(tabContent => {
        tabContent.classList.remove('active');
      });
      tabs.forEach(tab => {
        tab.classList.remove('active');
      });
      tab.classList.add('active');
      target.classList.add('active');
      updateSearchPlaceholder();
    });
  });

  searchInput.addEventListener('input', () => {
    const searchTerm = searchInput.value.toLowerCase();
    const activeTabContent = document.querySelector('.tab-content.active');
    const items = activeTabContent.querySelectorAll('.list-item');
    let visibleCount = 0;

    items.forEach(item => {
      const text = item.textContent.toLowerCase();
      const isVisible = text.includes(searchTerm);
      item.style.display = isVisible ? 'block' : 'none';
      if (isVisible) visibleCount++;
    });

    updateSearchPlaceholder(visibleCount);
  });

  function updateSearchPlaceholder(count) {
    const activeTabContent = document.querySelector('.tab-content.active');
    const items = activeTabContent.querySelectorAll('.list-item');
    const itemCount = count !== undefined ? count : items.length;
    searchInput.placeholder = `Search... (${itemCount} items)`;
  }

  // Keyboard navigation and selection for list items
  let currentIndex = 0;
  document.addEventListener('keydown', (e) => {
    const currentTabIndex = [...tabs].findIndex(tab => tab.classList.contains('active'));
    const activeTabContent = document.querySelector('.tab-content.active');
    const items = [...activeTabContent.querySelectorAll('.list-item')];

    let newIndex;
    let newTabIndex;

    if (items.length === 0) return;

    switch (e.key) {
      case 'ArrowLeft':
        newTabIndex = (currentTabIndex - 1 + tabs.length) % tabs.length;
        tabs[newTabIndex].click();
        break;
      case 'ArrowRight':
        newTabIndex = (currentTabIndex + 1) % tabs.length;
        tabs[newTabIndex].click();
        break;
      case 'ArrowUp':
        if (searchInput === document.activeElement) {
          // If the search input is focused, move focus to the last item
          items[items.length - 1].focus();
          currentIndex = items.length - 1;
        } else {
          newIndex = (currentIndex - 1 + items.length) % items.length;
          items[newIndex].focus();
          currentIndex = newIndex;
        }
        break;
      case 'ArrowDown':
        if (searchInput === document.activeElement) {
          // If the search input is focused, move focus to the first item
          items[0].focus();
          currentIndex = 0;
        } else {
          newIndex = (currentIndex + 1) % items.length;
          items[newIndex].focus();
          currentIndex = newIndex;
        }
        break;
      // case 'Home':
      //   searchInput.focus();
      //   break;
      case 'End':
        items[items.length - 1].focus();
        currentIndex = items.length - 1;
        break;
      case ' ':
        e.preventDefault();
        items[currentIndex].classList.toggle('selected');
        items[currentIndex].classList.contains('bg-blue-100') ? items[currentIndex].classList.remove('bg-blue-100') : items[currentIndex].classList.add('bg-blue-100');
        break;
      case 'Delete':
        const selectedItems = activeTabContent.querySelectorAll('.list-item.selected');
        selectedItems.forEach(item => item.remove());
        updateSearchPlaceholder();
        break;
      default:
        // if anything else, assume it's a search term
        searchInput.focus();
        break;
    }
  });

  // Click event for removing items
  document.addEventListener('click', (e) => {
    if (e.target.classList.contains('remove-btn')) {
      e.target.parentElement.remove();
      updateSearchPlaceholder();
    }
  });

  // Initialize the search placeholder with the count of items in the active tab
  updateSearchPlaceholder();
</script>
</body>
</html>